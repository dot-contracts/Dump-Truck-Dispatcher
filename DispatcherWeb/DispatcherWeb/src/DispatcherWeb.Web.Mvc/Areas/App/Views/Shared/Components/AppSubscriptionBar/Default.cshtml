@using Abp.MultiTenancy
@using DispatcherWeb.Authorization
@using DispatcherWeb.Editions
@{
    Layout = null;
}
@if (await Session.GetMultiTenancySideAsync() != MultiTenancySides.Host)
{
    if (await IsGrantedAsync(AppPermissions.Pages_Administration_Tenant_SubscriptionManagement)
        && (Model.LoginInformations.Tenant.IsInTrialPeriod || Model.LoginInformations.Tenant.SubscriptionIsExpiringSoon(Model.SubscriptionExpireNootifyDayCount)))
    {
        <style asp-add-nonce>
            .m-header--fixed .m-body {
                margin-top: 30px !important;
            }

            @@media (min-width: 1024px) {
                .m-header--fixed .m-body, .m-aside-left--fixed.m-header--fixed .m-aside-left, .m-aside-left--fixed.m-header--static .m-aside-left {
                    margin-top: 30px !important;
                }
            }
        </style>
        <div class="alert subscription-info">
            @if (Model.LoginInformations.Tenant.IsInTrialPeriod && !Model.LoginInformations.Tenant.SubscriptionIsExpiringSoon(Model.SubscriptionExpireNootifyDayCount))
            {
                @Html.Raw(L("TrialSubscriptionNotification",
                         "<strong>" + Model.LoginInformations.Tenant.Edition.DisplayName + "</strong>",
                         "<a href='" + Url.Action("Buy", "Payment", new { area = "", editionId = Model.LoginInformations.Tenant.Edition.Id, editionPaymentType = EditionPaymentType.BuyNow }) + "'>" + L("ClickHere") + "</a>")
                         )
            }
            @if (Model.LoginInformations.Tenant.SubscriptionIsExpiringSoon(Model.SubscriptionExpireNootifyDayCount))
            {
                <a href="@Url.Action("Index", "SubscriptionManagement", new {area = "App"})">
                    @if (Model.LoginInformations.Tenant.IsInTrialPeriod)
                    {
                        <span><i class="fa fa-exclamation-circle"></i> @L("TrialExpireNotification", Model.LoginInformations.Tenant.GetSubscriptionExpiringDayCount())</span>
                    }
                    else
                    {
                        <span><i class="fa fa-exclamation-circle"></i> @L("SubscriptionExpireNotification", Model.LoginInformations.Tenant.GetSubscriptionExpiringDayCount())</span>
                    }
                </a>
            }
        </div>
    }
}
